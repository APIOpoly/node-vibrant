!function t(r,n,o){function e(s,u){if(!n[s]){if(!r[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=n[s]={exports:{}};r[s][0].call(c.exports,function(t){var n=r[s][1][t];return e(n?n:t)},c,c.exports,t,r,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)e(o[s]);return e}({1:[function(t,r,n){if(!o)var o={map:function(t,r){var n={};return r?t.map(function(t,o){return n.index=o,r.call(n,t)}):t.slice()},naturalOrder:function(t,r){return r>t?-1:t>r?1:0},sum:function(t,r){var n={};return t.reduce(r?function(t,o,e){return n.index=e,t+r.call(n,o)}:function(t,r){return t+r},0)},max:function(t,r){return Math.max.apply(null,r?o.map(t,r):t)}};var e=function(){function t(t,r,n){return(t<<2*h)+(r<<h)+n}function r(t){function r(){n.sort(t),o=!0}var n=[],o=!1;return{push:function(t){n.push(t),o=!1},peek:function(t){return o||r(),void 0===t&&(t=n.length-1),n[t]},pop:function(){return o||r(),n.pop()},size:function(){return n.length},map:function(t){return n.map(t)},debug:function(){return o||r(),n}}}function n(t,r,n,o,e,i,s){var u=this;u.r1=t,u.r2=r,u.g1=n,u.g2=o,u.b1=e,u.b2=i,u.histo=s}function e(){this.vboxes=new r(function(t,r){return o.naturalOrder(t.vbox.count()*t.vbox.volume(),r.vbox.count()*r.vbox.volume())})}function i(r){var n,o,e,i,s=1<<3*h,u=new Array(s);return r.forEach(function(r){o=r[0]>>c,e=r[1]>>c,i=r[2]>>c,n=t(o,e,i),u[n]=(u[n]||0)+1}),u}function s(t,r){var o,e,i,s=1e6,u=0,a=1e6,h=0,p=1e6,f=0;return t.forEach(function(t){o=t[0]>>c,e=t[1]>>c,i=t[2]>>c,s>o?s=o:o>u&&(u=o),a>e?a=e:e>h&&(h=e),p>i?p=i:i>f&&(f=i)}),new n(s,u,a,h,p,f,r)}function u(r,n){function e(t){var r,o,e,i,s,u=t+"1",a=t+"2",c=0;for(h=n[u];h<=n[a];h++)if(v[h]>g/2){for(e=n.copy(),i=n.copy(),r=h-n[u],o=n[a]-h,s=o>=r?Math.min(n[a]-1,~~(h+o/2)):Math.max(n[u],~~(h-1-r/2));!v[s];)s++;for(c=m[s];!c&&v[s-1];)c=m[--s];return e[a]=s,i[u]=e[a]+1,[e,i]}}if(n.count()){var i=n.r2-n.r1+1,s=n.g2-n.g1+1,u=n.b2-n.b1+1,a=o.max([i,s,u]);if(1==n.count())return[n.copy()];var h,c,p,f,l,g=0,v=[],m=[];if(a==i)for(h=n.r1;h<=n.r2;h++){for(f=0,c=n.g1;c<=n.g2;c++)for(p=n.b1;p<=n.b2;p++)l=t(h,c,p),f+=r[l]||0;g+=f,v[h]=g}else if(a==s)for(h=n.g1;h<=n.g2;h++){for(f=0,c=n.r1;c<=n.r2;c++)for(p=n.b1;p<=n.b2;p++)l=t(c,h,p),f+=r[l]||0;g+=f,v[h]=g}else for(h=n.b1;h<=n.b2;h++){for(f=0,c=n.r1;c<=n.r2;c++)for(p=n.g1;p<=n.g2;p++)l=t(c,p,h),f+=r[l]||0;g+=f,v[h]=g}return v.forEach(function(t,r){m[r]=g-t}),e(a==i?"r":a==s?"g":"b")}}function a(t,n){function a(t,r){for(var n,o=1,e=0;p>e;)if(n=t.pop(),n.count()){var i=u(h,n),s=i[0],a=i[1];if(!s)return;if(t.push(s),a&&(t.push(a),o++),o>=r)return;if(e++>p)return}else t.push(n),e++}if(!t.length||2>n||n>256)return!1;var h=i(t),c=0;h.forEach(function(){c++});var l=s(t,h),g=new r(function(t,r){return o.naturalOrder(t.count(),r.count())});g.push(l),a(g,f*n);for(var v=new r(function(t,r){return o.naturalOrder(t.count()*t.volume(),r.count()*r.volume())});g.size();)v.push(g.pop());a(v,n-v.size());for(var m=new e;v.size();)m.push(v.pop());return m}var h=5,c=8-h,p=1e3,f=.75;return n.prototype={volume:function(t){var r=this;return(!r._volume||t)&&(r._volume=(r.r2-r.r1+1)*(r.g2-r.g1+1)*(r.b2-r.b1+1)),r._volume},count:function(r){var n=this,o=n.histo;if(!n._count_set||r){var e,i,s,u=0;for(e=n.r1;e<=n.r2;e++)for(i=n.g1;i<=n.g2;i++)for(s=n.b1;s<=n.b2;s++)index=t(e,i,s),u+=o[index]||0;n._count=u,n._count_set=!0}return n._count},copy:function(){var t=this;return new n(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(r){var n=this,o=n.histo;if(!n._avg||r){var e,i,s,u,a,c=0,p=1<<8-h,f=0,l=0,g=0;for(i=n.r1;i<=n.r2;i++)for(s=n.g1;s<=n.g2;s++)for(u=n.b1;u<=n.b2;u++)a=t(i,s,u),e=o[a]||0,c+=e,f+=e*(i+.5)*p,l+=e*(s+.5)*p,g+=e*(u+.5)*p;n._avg=c?[~~(f/c),~~(l/c),~~(g/c)]:[~~(p*(n.r1+n.r2+1)/2),~~(p*(n.g1+n.g2+1)/2),~~(p*(n.b1+n.b2+1)/2)]}return n._avg},contains:function(t){var r=this,n=t[0]>>c;return gval=t[1]>>c,bval=t[2]>>c,n>=r.r1&&n<=r.r2&&gval>=r.g1&&gval<=r.g2&&bval>=r.b1&&bval<=r.b2}},e.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var r=this.vboxes,n=0;n<r.size();n++)if(r.peek(n).vbox.contains(t))return r.peek(n).color;return this.nearest(t)},nearest:function(t){for(var r,n,o,e=this.vboxes,i=0;i<e.size();i++)n=Math.sqrt(Math.pow(t[0]-e.peek(i).color[0],2)+Math.pow(t[1]-e.peek(i).color[1],2)+Math.pow(t[2]-e.peek(i).color[2],2)),(r>n||void 0===r)&&(r=n,o=e.peek(i).color);return o},forcebw:function(){var t=this.vboxes;t.sort(function(t,r){return o.naturalOrder(o.sum(t.color),o.sum(r.color))});var r=t[0].color;r[0]<5&&r[1]<5&&r[2]<5&&(t[0].color=[0,0,0]);var n=t.length-1,e=t[n].color;e[0]>251&&e[1]>251&&e[2]>251&&(t[n].color=[255,255,255])}},{quantize:a}}();r.exports=e.quantize},{}],2:[function(t,r,n){var o;o=t("./vibrant"),o.DefaultOpts.Image=t("./image/browser"),r.exports=o},{"./image/browser":8,"./vibrant":21}],3:[function(t,r,n){var o;window.Vibrant=o=t("./browser")},{"./browser":2}],4:[function(t,r,n){r.exports=function(t,r,n,o){return o>=125&&!(t>250&&r>250&&n>250)}},{}],5:[function(t,r,n){r.exports.Default=t("./default")},{"./default":4}],6:[function(t,r,n){var o,e,i,s,u,a=function(t,r){function n(){this.constructor=t}for(var o in r)h.call(r,o)&&(t[o]=r[o]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t},h={}.hasOwnProperty,c=[].slice;s=t("../swatch"),u=t("../util"),i=t("./index"),e={targetDarkLuma:.26,maxDarkLuma:.45,minLightLuma:.55,targetLightLuma:.74,minNormalLuma:.3,targetNormalLuma:.5,maxNormalLuma:.7,targetMutesSaturation:.3,maxMutesSaturation:.4,targetVibrantSaturation:1,minVibrantSaturation:.35,weightSaturation:3,weightLuma:6,weightPopulation:1},r.exports=o=function(t){function r(t){this.opts=u.defaults(t,e),this.VibrantSwatch=null,this.LightVibrantSwatch=null,this.DarkVibrantSwatch=null,this.MutedSwatch=null,this.LightMutedSwatch=null,this.DarkMutedSwatch=null}return a(r,t),r.prototype.HighestPopulation=0,r.prototype.generate=function(t){return this.swatches=t,this.maxPopulation=this.findMaxPopulation,this.generateVarationColors(),this.generateEmptySwatches()},r.prototype.getVibrantSwatch=function(){return this.VibrantSwatch},r.prototype.getLightVibrantSwatch=function(){return this.LightVibrantSwatch},r.prototype.getDarkVibrantSwatch=function(){return this.DarkVibrantSwatch},r.prototype.getMutedSwatch=function(){return this.MutedSwatch},r.prototype.getLightMutedSwatch=function(){return this.LightMutedSwatch},r.prototype.getDarkMutedSwatch=function(){return this.DarkMutedSwatch},r.prototype.generateVarationColors=function(){return this.VibrantSwatch=this.findColorVariation(this.opts.targetNormalLuma,this.opts.minNormalLuma,this.opts.maxNormalLuma,this.opts.targetVibrantSaturation,this.opts.minVibrantSaturation,1),this.LightVibrantSwatch=this.findColorVariation(this.opts.targetLightLuma,this.opts.minLightLuma,1,this.opts.targetVibrantSaturation,this.opts.minVibrantSaturation,1),this.DarkVibrantSwatch=this.findColorVariation(this.opts.targetDarkLuma,0,this.opts.maxDarkLuma,this.opts.targetVibrantSaturation,this.opts.minVibrantSaturation,1),this.MutedSwatch=this.findColorVariation(this.opts.targetNormalLuma,this.opts.minNormalLuma,this.opts.maxNormalLuma,this.opts.targetMutesSaturation,0,this.opts.maxMutesSaturation),this.LightMutedSwatch=this.findColorVariation(this.opts.targetLightLuma,this.opts.minLightLuma,1,this.opts.targetMutesSaturation,0,this.opts.maxMutesSaturation),this.DarkMutedSwatch=this.findColorVariation(this.opts.targetDarkLuma,0,this.opts.maxDarkLuma,this.opts.targetMutesSaturation,0,this.opts.maxMutesSaturation)},r.prototype.generateEmptySwatches=function(){var t;return null===this.VibrantSwatch&&null!==this.DarkVibrantSwatch&&(t=this.DarkVibrantSwatch.getHsl(),t[2]=this.opts.targetNormalLuma,this.VibrantSwatch=new s(u.hslToRgb(t[0],t[1],t[2]),0)),null===this.DarkVibrantSwatch&&null!==this.VibrantSwatch?(t=this.VibrantSwatch.getHsl(),t[2]=this.opts.targetDarkLuma,this.DarkVibrantSwatch=new s(u.hslToRgb(t[0],t[1],t[2]),0)):void 0},r.prototype.findMaxPopulation=function(){var t,r,n,o,e;for(n=0,o=this.swatches,t=0,r=o.length;r>t;t++)e=o[t],n=Math.max(n,e.getPopulation());return n},r.prototype.findColorVariation=function(t,r,n,o,e,i){var s,u,a,h,c,p,f,l,g;for(h=null,c=0,p=this.swatches,s=0,u=p.length;u>s;s++)l=p[s],f=l.getHsl()[1],a=l.getHsl()[2],f>=e&&i>=f&&a>=r&&n>=a&&!this.isAlreadySelected(l)&&(g=this.createComparisonValue(f,o,a,t,l.getPopulation(),this.HighestPopulation),(null===h||g>c)&&(h=l,c=g));return h},r.prototype.createComparisonValue=function(t,r,n,o,e,i){return this.weightedMean(this.invertDiff(t,r),this.opts.weightSaturation,this.invertDiff(n,o),this.opts.weightLuma,e/i,this.opts.weightPopulation)},r.prototype.invertDiff=function(t,r){return 1-Math.abs(t-r)},r.prototype.weightedMean=function(){var t,r,n,o,e,i;for(e=1<=arguments.length?c.call(arguments,0):[],r=0,n=0,t=0;t<e.length;)o=e[t],i=e[t+1],r+=o*i,n+=i,t+=2;return r/n},r.prototype.isAlreadySelected=function(t){return this.VibrantSwatch===t||this.DarkVibrantSwatch===t||this.LightVibrantSwatch===t||this.MutedSwatch===t||this.DarkMutedSwatch===t||this.LightMutedSwatch===t},r}(i)},{"../swatch":19,"../util":20,"./index":7}],7:[function(t,r,n){var o;r.exports=o=function(){function t(){}return t.prototype.generate=function(t){},t.prototype.getVibrantSwatch=function(){},t.prototype.getLightVibrantSwatch=function(){},t.prototype.getDarkVibrantSwatch=function(){},t.prototype.getMutedSwatch=function(){},t.prototype.getLightMutedSwatch=function(){},t.prototype.getDarkMutedSwatch=function(){},t}(),r.exports.Default=t("./default")},{"./default":6}],8:[function(t,r,n){var o,e,i=function(t,r){function n(){this.constructor=t}for(var o in r)s.call(r,o)&&(t[o]=r[o]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t},s={}.hasOwnProperty;e=t("./index"),r.exports=o=function(t){function r(t,r){this.img=document.createElement("img"),this.img.crossOrigin="anonymous",this.img.src=t,this.img.onload=function(t){return function(){return t._initCanvas(),"function"==typeof r?r(null,t):void 0}}(this),this.img.onerror=function(n){return function(n){var o;return o=new Error("Fail to load image: "+t),o.raw=n,"function"==typeof r?r(o):void 0}}(this)}return i(r,t),r.prototype._initCanvas=function(){return this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=this.img.width,this.height=this.canvas.height=this.img.height,this.context.drawImage(this.img,0,0,this.width,this.height)},r.prototype.clear=function(){return this.context.clearRect(0,0,this.width,this.height)},r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.resize=function(t,r,n){return this.width=this.canvas.width=t,this.height=this.canvas.height=r,this.context.scale(n,n),this.context.drawImage(this.img,0,0)},r.prototype.update=function(t){return this.context.putImageData(t,0,0)},r.prototype.getPixelCount=function(){return this.width*this.height},r.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},r.prototype.removeCanvas=function(){return this.canvas.parentNode.removeChild(this.canvas)},r}(e)},{"./index":9}],9:[function(t,r,n){var o;r.exports=o=function(){function t(){}return t.prototype.clear=function(){},t.prototype.update=function(t){},t.prototype.getWidth=function(){},t.prototype.getHeight=function(){},t.prototype.scaleDown=function(t){var r,n,o,e;return e=this.getWidth(),r=this.getHeight(),o=1,null!=t.maxDimension?(n=Math.max(e,r),n>t.maxDimension&&(o=t.maxDimension/n)):o=1/t.quality,1>o?this.resize(e*o,r*o,o):void 0},t.prototype.resize=function(t,r,n){},t.prototype.getPixelCount=function(){},t.prototype.getImageData=function(){},t.prototype.removeCanvas=function(){},t}()},{}],10:[function(t,r,n){var o,e,i,s,u=function(t,r){function n(){this.constructor=t}for(var o in r)a.call(r,o)&&(t[o]=r[o]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t},a={}.hasOwnProperty;i=t("../swatch"),e=t("./index"),s=t("quantize"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return u(r,t),r.prototype.initialize=function(t,r){var n,o,e,u,a,h,c,p,f;for(this.opts=r,p=t.length/4,o=[],h=0;p>h;)c=4*h,f=t[c+0],a=t[c+1],e=t[c+2],n=t[c+3],n>=125&&(f>250&&a>250&&e>250||o.push([f,a,e])),h+=this.opts.quality;return u=s(o,this.opts.colorCount),this.swatches=u.vboxes.map(function(t){return function(t){return new i(t.color,t.vbox.count())}}(this))},r.prototype.getQuantizedColors=function(){return this.swatches},r}(e)},{"../swatch":19,"./index":16,quantize:1}],11:[function(t,r,n){var o,e,i,s,u=function(t,r){function n(){this.constructor=t}for(var o in r)a.call(r,o)&&(t[o]=r[o]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t},a={}.hasOwnProperty;s=t("../swatch"),i=t("./index"),o=t("./impl/color-cut"),r.exports=e=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return u(r,t),r.prototype.initialize=function(t,r){var n,e,i;return this.opts=r,n=new ArrayBuffer(t.length),e=new Uint8ClampedArray(n),i=new Uint32Array(n),e.set(t),this.quantizer=new o(i,this.opts)},r.prototype.getQuantizedColors=function(){return this.quantizer.getQuantizedColors()},r}(i)},{"../swatch":19,"./impl/color-cut":12,"./index":16}],12:[function(t,r,n){var o,e,i,s,u,a,h,c,p,f,l,g,v,m,b,y,d,w,x,S;f=t("../../swatch"),S=function(t,r,n){var o,e,i;return i=function(r,n){var o;return o=t[r],t[r]=t[n],t[n]=o},o=function(r,n,o){var e,s,u,a,h,c;for(e=n,c=t[r],i(r,o),h=s=u=n,a=o-1;a>=u?a>=s:s>=a;h=a>=u?++s:--s)t[h]>c&&(i(h,e),e++);return i(o,e),e},n>r?(e=r+Math.ceil((n-r)/2),e=o(e,r,n),S(t,r,e-1),S(t,e+1,n)):void 0},s=-3,i=-2,e=-1,c=5,h=(1<<c)-1,p={red:function(t){return t>>24},green:function(t){return t<<8>>24},blue:function(t){return t<<16>>24},alpha:function(t){return t<<24>>24}},o={red:function(t){return t<<24>>24},green:function(t){return t<<16>>24},blue:function(t){return t<<8>>24},alpha:function(t){return t>>24}},v=function(){var t,r,n;if(t=new ArrayBuffer(4),r=new Uint8Array(t),n=new Uint32Array(t),r[0]=161,r[1]=178,r[2]=195,r[3]=212,3569595041===n[0])return!0;if(2712847316===n[0])return!1;throw new Error("Failed to determin endianness")},u=v()?o:p,b=function(t,r,n){var o;return o=0,o=n>r?t<<n-r:t>>r-n,o&(1<<n)-1},m=function(t,r,n,o){var u,a,h,p,f,l,g,v;switch(r){case s:break;case i:for(a=h=f=n,l=o;l>=f?l>=h:h>=l;a=l>=f?++h:--h)u=t[a],t[a]=w(u)<<c+c|x(u)<<c|d(u);break;case e:for(a=p=g=n,v=o;v>=g?v>=p:p>=v;a=v>=g?++p:--p)u=t[a],t[a]=d(u)<<c+c|w(u)<<c|x(u)}},y=function(t){var r,n,o;return o=b(u.red(t),8,c),n=b(u.green(t),8,c),r=b(u.blue(t),8,c),o<<c+c|n<<c|r},g=function(t,r,n){var o;return(null==r||null==n)&&(o=t,t=x(o),r=w(o),n=d(o)),[b(t,c,8),b(r,c,8),b(n,c,8)]},x=function(t){return t>>c+c&h},w=function(t){return t>>c&h},d=function(t){return t&h},r.exports=a=function(){function t(t,r){var n,o,e,i,s,u,a,h,p,l,v,m,b,d;for(this.opts=r,this.hist=new Uint32Array(1<<3*c),this.pixels=new Uint32Array(t.length),s=u=0,v=t.length-1;v>=0?v>=u:u>=v;s=v>=0?++u:--u)this.pixels[s]=l=y(t[s]),this.hist[l]++;for(e=0,o=a=0,m=this.hist.length-1;m>=0?m>=a:a>=m;o=m>=0?++a:--a)this.hist[o]>0&&e++;for(this.colors=new Uint32Array(e),i=0,o=h=0,b=this.hist.length-1;b>=0?b>=h:h>=b;o=b>=0?++h:--h)this.hist[o]>0&&(this.colors[i++]=o);if(e<=this.opts.colorCount)for(this.quantizedColors=[],s=p=0,d=this.colors.length-1;d>=0?d>=p:p>=d;s=d>=0?++p:--p)n=this.colors[s],this.quantizedColors.push(new f(g(n),this.hist[n]));else this.quantizedColors=this.quantizePixels(this.opts.colorCount)}return t.prototype.getQuantizedColors=function(){return this.quantizedColors},t.prototype.quantizePixels=function(t){var r;return r=new PriorityQueue({comparator:l.comparator}),r.queue(new l(this.colors,this.hist,0,this.colors.length-1)),this.splitBoxes(r,t),this.generateAverageColors(r)},t.prototype.splitBoxes=function(t,r){for(var n;t.length<r;){if(n=t.dequeue(),null!=n?!n.canSplit():!0)return;t.queue(n.splitBox()),t.queue(n)}},t.prototype.generateAverageColors=function(t){var r;for(r=[];t.length>0;)r.push(t.dequeue().getAverageColor());return r},t}(),l=function(){function t(t,r,n,o){this.colors=t,this.hist=r,this.lowerIndex=n,this.upperIndex=o,this.fitBox()}return t.comparator=function(t,r){return t.getVolume()-r.getVolume()},t.prototype.getVolume=function(){return(this.maxRed-this.minRed+1)*(this.maxGreen-this.minGreen+1)*(this.maxBlue-this.minBlue+1)},t.prototype.canSplit=function(){return this.getColorCount()>1},t.prototype.getColorCount=function(){return 1+this.upperIndex-this.lowerIndex},t.prototype.fitBox=function(){var t,r,n,o,e,i,s,u,a;for(this.minRed=this.minGreen=this.minBlue=Number.MAX_VALUE,this.maxRed=this.maxGreen=this.maxBlue=Number.MIN_VALUE,this.population=0,n=0,e=i=u=this.lowerIndex,a=this.upperIndex;a>=u?a>=i:i>=a;e=a>=u?++i:--i)r=this.colors[e],n+=this.hist[r],s=x(r),o=w(r),t=d(r),s>this.maxRed&&(this.maxRed=s),s<this.minRed&&(this.minRed=s),o>this.maxGreen&&(this.maxGreen=o),o<this.minGreen&&(this.minGreen=o),t>this.maxBlue&&(this.maxRed=t),t<this.minBlue&&(this.minRed=t);return this.population=n},t.prototype.splitBox=function(){var r,n;if(!this.canSplit())throw new Error("Cannot split a box with only 1 color");return n=this.findSplitPoint(),r=new t(this.colors,this.hist,n+1,this.upperIndex),this.upperIndex=n,this.fitBox(),r},t.prototype.getLongestColorDimension=function(){var t,r,n;return n=this.maxRed-this.minRed,r=this.maxGreen-this.minGreen,t=this.maxBlue-this.minBlue,n>=r&&n>=t?s:r>=n&&r>=t?i:e},t.prototype.findSplitPoint=function(){var t,r,n,o,e,i,s;for(o=this.getLongestColorDimension(),m(this.colors,o,this.lowerIndex,this.upperIndex),S(this.colors,this.lowerIndex,this.upperIndex+1),m(this.colors,o,this.lowerIndex,this.upperIndex),e=this.population/2,t=0,r=n=i=this.lowerIndex,s=this.upperIndex;s>=i?s>=n:n>=s;r=s>=i?++n:--n)if(t+=this.hist[this.colors[r]],t>=e)return r;return this.lowerIndex},t.prototype.getAverageColor=function(){var t,r,n,o,e,i,s,u,a,h,c,p,l;for(h=i=r=0,l=0,s=u=c=this.lowerIndex,p=this.upperIndex;p>=c?p>=u:u>=p;s=p>=c?++u:--u)n=this.colors[s],o=this.hist[n],l+=o,h+=o*x(n),i+=o*w(n),r+=o*d(n);return a=Math.round(h/l),e=Math.round(i/l),t=Math.round(r/l),new f(g(a,e,t),l)},t}()},{"../../swatch":19}],13:[function(t,r,n){var o,e,i,s,u,a,h,c,p;c=p=t("../../util"),h=c.getColorIndex,s=c.SIGBITS,i=c.RSHIFT,u=t("../../swatch"),a=t("./vbox"),e=t("./pqueue"),r.exports=o=function(){function t(t){this.opts=p.defaults(t,this.constructor.DefaultOpts)}return t.DefaultOpts={maxIterations:1e3,fractByPopulations:.75},t.prototype.quantize=function(t,r){var n,o,i,s,h,c,p,f,l;if(0===t.length||r.colorCount<2||r.colorCount>256)throw new Error("Wrong MMCQ parameters");for(c=function(){return!1},Array.isArray(r.filters)&&r.filters.length>0&&(c=function(t,n,o,e){var i,s,u,a;for(a=r.filters,s=0,u=a.length;u>s;s++)if(i=a[s],!i(t,n,o,e))return!0;return!1}),l=a.build(t,c),i=l.hist,o=Object.keys(i).length,s=new e(function(t,r){return t.count()-r.count()}),s.push(l),this._splitBoxes(s,this.opts.fractByPopulations*r.colorCount),h=new e(function(t,r){return t.count()*t.volume()-r.count()*r.volume()}),h.contents=s.contents,this._splitBoxes(h,r.colorCount-h.size()),p=[],this.vboxes=[];h.size();)f=h.pop(),n=f.avg(),("function"==typeof c?c(n[0],n[1],n[2],255):void 0)||(this.vboxes.push(f),p.push(new u(n,f.count())));return p},t.prototype._splitBoxes=function(t,r){var n,o,e,i,s,u,a;for(n=1,o=0,e=this.opts.maxIterations;e>o;)if(o++,s=t.pop(),s.count()&&(i=s.split(),u=i[0],a=i[1],t.push(u),a&&(t.push(a),n++),n>=r||o>e))return},t}()},{"../../swatch":19,"../../util":20,"./pqueue":14,"./vbox":15}],14:[function(t,r,n){var o;r.exports=o=function(){function t(t){this.comparator=t,this.contents=[],this.sorted=!1}return t.prototype._sort=function(){return this.contents.sort(this.comparator),this.sorted=!0},t.prototype.push=function(t){return this.contents.push(t),this.sorted=!1},t.prototype.peek=function(t){return this.sorted||this._sort(),null==t&&(t=this.contents.length-1),this.contents[t]},t.prototype.pop=function(){return this.sorted||this._sort(),this.contents.pop()},t.prototype.size=function(){return this.contents.length},t.prototype.map=function(t){return this.sorted||this._sort(),this.contents.map(t)},t}()},{}],15:[function(t,r,n){var o,e,i,s,u,a;u=a=t("../../util"),s=u.getColorIndex,e=u.SIGBITS,o=u.RSHIFT,r.exports=i=function(){function t(t,r,n,o,e,i,s){this.r1=t,this.r2=r,this.g1=n,this.g2=o,this.b1=e,this.b2=i,this.hist=s}return t.build=function(r,n){var i,u,a,h,c,p,f,l,g,v,m,b,y,d,w,x;for(g=1<<3*e,l=new Uint32Array(g),w=p=a=0,x=f=h=Number.MAX_VALUE,b=r.length/4,v=0;b>v;)y=4*v,v++,d=r[y+0],c=r[y+1],u=r[y+2],i=r[y+3],n(d,c,u,i)||(d>>=o,c>>=o,u>>=o,m=s(d,c,u),l[m]+=1,d>w&&(w=d),x>d&&(x=d),c>p&&(p=c),f>c&&(f=c),u>a&&(a=u),h>u&&(h=u));return new t(x,w,f,p,h,a,l)},t.prototype.invalidate=function(){return delete this._count,delete this._avg,delete this._volume},t.prototype.volume=function(){return null==this._volume&&(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},t.prototype.count=function(){var t,r;if(null==this._count){r=this.hist,t=0;for(var n=this.r1;n<=this.r2;n++)for(var o=this.g1;o<=this.g2;o++)for(var e=this.b1;e<=this.b2;e++){var i=s(n,o,e);t+=r[i]}this._count=t}return this._count},t.prototype.clone=function(){return new t(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.hist)},t.prototype.avg=function(){var t,r,n,o,i,u;if(null==this._avg){n=this.hist,i=0,o=1<<8-e,u=r=t=0;for(var a=this.r1;a<=this.r2;a++)for(var h=this.g1;h<=this.g2;h++)for(var c=this.b1;c<=this.b2;c++){var p=s(a,h,c),f=n[p];i+=f,u+=f*(a+.5)*o,r+=f*(h+.5)*o,t+=f*(c+.5)*o}this._avg=i?[~~(u/i),~~(r/i),~~(t/i)]:[~~(o*(this.r1+this.r2+1)/2),~~(o*(this.g1+this.g2+1)/2),~~(o*(this.b1+this.b2+1)/2)]}return this._avg},t.prototype.split=function(){var t,r,n,o,e,i,u,a,h,c,p,f,l,g,v,m,b;if(i=this.hist,!this.count())return null;if(1===this.count())return[this.clone()];switch(l=this.r2-this.r1+1,e=this.g2-this.g1+1,r=this.b2-this.b1+1,c=Math.max(l,e,r),t=null,v=m=0,h=null,c){case l:h="r",t=new Uint32Array(this.r2+1);for(var y=this.r1;y<=this.r2;y++){v=0;for(var d=this.g1;d<=this.g2;d++)for(var w=this.b1;w<=this.b2;w++){var x=s(y,d,w);v+=i[x]}m+=v,t[y]=m}break;case e:h="g",t=new Uint32Array(this.g2+1);for(var d=this.g1;d<=this.g2;d++){v=0;for(var y=this.r1;y<=this.r2;y++)for(var w=this.b1;w<=this.b2;w++){var x=s(y,d,w);v+=i[x]}m+=v,t[d]=m}break;case r:h="b",t=new Uint32Array(this.b2+1);for(var w=this.b1;w<=this.b2;w++){v=0;for(var y=this.r1;y<=this.r2;y++)for(var d=this.g1;d<=this.g2;d++){var x=s(y,d,w);v+=i[x]}m+=v,t[w]=m}}for(g=-1,f=new Uint32Array(t.length),u=a=0,p=t.length-1;p>=0?p>=a:a>=p;u=p>=0?++a:--a)n=t[u],0>g&&n>m/2&&(g=u),f[u]=m-n;return b=this,(o=function(r){var n,o,e,i,s,u,a,h,c;for(i=r+"1",s=r+"2",o=b[i],e=b[s],h=b.clone(),c=b.clone(),u=g-o,a=e-g,a>=u?(e=Math.min(e-1,~~(g+a/2)),e=Math.max(0,e)):(e=Math.max(o,~~(g-1-u/2)),e=Math.min(b[s],e));!t[e];)e++;for(n=f[e];!n&&t[e-1];)n=f[--e];return h[s]=e,c[i]=e+1,[h,c]})(h)},t.prototype.contains=function(t){var r,n,e;return e=t[0]>>o,n=t[1]>>o,r=t[2]>>o,e>=this.r1&&e<=this.r2&&n>=this.g1&&n<=this.g2&&r>=this.b1&&r<=this.b2},t}()},{"../../util":20}],16:[function(t,r,n){var o;r.exports=o=function(){function t(){}return t.prototype.initialize=function(t,r){},t.prototype.getQuantizedColors=function(){},t}(),r.exports.Baseline=t("./baseline"),r.exports.NoCopy=t("./nocopy"),r.exports.ColorCut=t("./color-cut"),r.exports.MMCQ=t("./mmcq")},{"./baseline":10,"./color-cut":11,"./mmcq":17,"./nocopy":18}],17:[function(t,r,n){var o,e,i,s,u=function(t,r){function n(){this.constructor=t}for(var o in r)a.call(r,o)&&(t[o]=r[o]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t},a={}.hasOwnProperty;s=t("../swatch"),i=t("./index"),e=t("./impl/mmcq"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return u(r,t),r.prototype.initialize=function(t,r){var n;return this.opts=r,n=new e,this.swatches=n.quantize(t,this.opts)},r.prototype.getQuantizedColors=function(){return this.swatches},r}(i)},{"../swatch":19,"./impl/mmcq":13,"./index":16}],18:[function(t,r,n){var o,e,i,s,u=function(t,r){function n(){this.constructor=t}for(var o in r)a.call(r,o)&&(t[o]=r[o]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t},a={}.hasOwnProperty;i=t("../swatch"),e=t("./index"),s=t("../../vendor-mod/quantize"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return u(r,t),r.prototype.initialize=function(t,r){var n;return this.opts=r,n=s(t,this.opts),this.swatches=n.vboxes.map(function(t){return function(t){return new i(t.color,t.vbox.count())}}(this))},r.prototype.getQuantizedColors=function(){return this.swatches},r}(e)},{"../../vendor-mod/quantize":22,"../swatch":19,"./index":16}],19:[function(t,r,n){var o,e;e=t("./util"),r.exports=o=function(){function t(t,r){this.rgb=t,this.population=r}return t.prototype.hsl=void 0,t.prototype.rgb=void 0,t.prototype.population=1,t.prototype.yiq=0,t.prototype.getHsl=function(){return this.hsl?this.hsl:this.hsl=e.rgbToHsl(this.rgb[0],this.rgb[1],this.rgb[2])},t.prototype.getPopulation=function(){return this.population},t.prototype.getRgb=function(){return this.rgb},t.prototype.getHex=function(){return e.rgbToHex(this.rgb[0],this.rgb[1],this.rgb[2])},t.prototype.getTitleTextColor=function(){return this._ensureTextColors(),this.yiq<200?"#fff":"#000"},t.prototype.getBodyTextColor=function(){return this._ensureTextColors(),this.yiq<150?"#fff":"#000"},t.prototype._ensureTextColors=function(){return this.yiq?void 0:this.yiq=(299*this.rgb[0]+587*this.rgb[1]+114*this.rgb[2])/1e3},t}()},{"./util":20}],20:[function(t,r,n){var o,e,i;o={NA:0,PERFECT:1,CLOSE:2,GOOD:10,SIMILAR:50},i=5,e=8-i,r.exports={clone:function(t){var r,n,o;if("object"==typeof t){if(Array.isArray(t))return t.map(function(t){return function(r){return t.clone(r)}}(this));r={};for(n in t)o=t[n],r[n]=this.clone(o);return r}return t},defaults:function(){var t,r,n,o,e,i;for(e={},r=0,o=arguments.length;o>r;r++){t=arguments[r];for(n in t)i=t[n],null==e[n]&&(e[n]=this.clone(i))}return e},hexToRgb:function(t){var r;return r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),null!=r?[r[1],r[2],r[3]].map(function(t){return parseInt(t,16)}):null},rgbToHex:function(t,r,n){return"#"+((1<<24)+(t<<16)+(r<<8)+n).toString(16).slice(1,7)},rgbToHsl:function(t,r,n){var o,e,i,s,u,a;if(t/=255,r/=255,n/=255,s=Math.max(t,r,n),u=Math.min(t,r,n),e=void 0,a=void 0,i=(s+u)/2,s===u)e=a=0;else{switch(o=s-u,a=i>.5?o/(2-s-u):o/(s+u),s){case t:e=(r-n)/o+(n>r?6:0);break;case r:e=(n-t)/o+2;break;case n:e=(t-r)/o+4}e/=6}return[e,a,i]},hslToRgb:function(t,r,n){var o,e,i,s,u,a;return a=void 0,e=void 0,o=void 0,i=function(t,r,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?t+6*(r-t)*n:.5>n?r:2/3>n?t+(r-t)*(2/3-n)*6:t},0===r?a=e=o=n:(u=.5>n?n*(1+r):n+r-n*r,s=2*n-u,a=i(s,u,t+1/3),e=i(s,u,t),o=i(s,u,t-1/3)),[255*a,255*e,255*o]},rgbToXyz:function(t,r,n){var o,e,i;return t/=255,r/=255,n/=255,t=t>.04045?Math.pow((t+.005)/1.055,2.4):t/12.92,r=r>.04045?Math.pow((r+.005)/1.055,2.4):r/12.92,n=n>.04045?Math.pow((n+.005)/1.055,2.4):n/12.92,t*=100,r*=100,n*=100,o=.4124*t+.3576*r+.1805*n,e=.2126*t+.7152*r+.0722*n,i=.0193*t+.1192*r+.9505*n,[o,e,i]},xyzToCIELab:function(t,r,n){var o,e,i,s,u,a;return e=95.047,i=100,s=108.883,t/=e,r/=i,n/=s,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,o=116*r-16,u=500*(t-r),a=200*(r-n),[o,u,a]},rgbToCIELab:function(t,r,n){var o,e,i,s;return o=this.rgbToXyz(t,r,n),e=o[0],i=o[1],s=o[2],this.xyzToCIELab(e,i,s)},deltaE94:function(t,r){var n,o,e,i,s,u,a,h,c,p,f,l,g,v,m,b,y,d,w,x;return s=1,e=1,i=1,n=t[0],u=t[1],h=t[2],o=r[0],a=r[1],c=r[2],p=n-o,f=u-a,l=h-c,g=Math.sqrt(u*u+h*h),v=Math.sqrt(a*a+c*c),d=o-n,m=v-g,b=Math.sqrt(p*p+f*f+l*l),y=Math.sqrt(b)>Math.sqrt(Math.abs(d))+Math.sqrt(Math.abs(m))?Math.sqrt(b*b-d*d-m*m):0,w=1+.045*g,x=1+.015*g,d/=s,m/=e*w,y/=i*x,Math.sqrt(d*d+m*m+y*y)},rgbDiff:function(t,r){var n,o;return n=this.rgbToCIELab.apply(this,t),o=this.rgbToCIELab.apply(this,r),this.deltaE94(n,o)},hexDiff:function(t,r){var n,o;return n=this.hexToRgb(t),o=this.hexToRgb(r),this.rgbDiff(n,o)},DELTAE94_DIFF_STATUS:o,getColorDiffStatus:function(t){return t<o.NA?"N/A":t<=o.PERFECT?"Perfect":t<=o.CLOSE?"Close":t<=o.GOOD?"Good":t<o.SIMILAR?"Similar":"Wrong"},SIGBITS:i,RSHIFT:e,getColorIndex:function(t,r,n){return(t<<2*i)+(r<<i)+n}}},{}],21:[function(t,r,n){var o,e,i,s,u,a,h=function(t,r){return function(){return t.apply(r,arguments)}};s=t("./swatch"),a=t("./util"),e=t("./generator").Default,i=t("./filter"),r.exports=u=function(){function r(t,r){this.sourceImage=t,null==r&&(r={}),this.swatches=h(this.swatches,this),this.opts=a.defaults(r,this.constructor.DefaultOpts),this.generator=this.opts.generator}return r.DefaultOpts={colorCount:64,quality:5,generator:new e,Image:null,Quantizer:t("./quantizer").MMCQ,filters:[]},r.from=function(t){return new o(t)},r.prototype.quantize=t("quantize"),r.prototype._swatches=[],r.prototype.getPalette=function(t){var r;return r=new this.opts.Image(this.sourceImage,function(r){return function(n,o){var e;if(null!=n)return t(n);try{return r._process(o,r.opts),t(null,r.swatches())}catch(i){return e=i,t(e)}}}(this))},r.prototype.getSwatches=function(t){return this.getPalette(t)},r.prototype._process=function(t,r){var n,o,e;return t.scaleDown(this.opts),n=t.getImageData(),o=new this.opts.Quantizer,o.initialize(n.data,this.opts),e=o.getQuantizedColors(),this.generator.generate(e),t.removeCanvas()},r.prototype.swatches=function(){return{Vibrant:this.generator.getVibrantSwatch(),Muted:this.generator.getMutedSwatch(),DarkVibrant:this.generator.getDarkVibrantSwatch(),DarkMuted:this.generator.getDarkMutedSwatch(),LightVibrant:this.generator.getLightVibrantSwatch(),LightMuted:this.generator.getLightMutedSwatch()}},r}(),r.exports.Builder=o=function(){function t(t,r){this.src=t,this.opts=null!=r?r:{},this.opts.filters=a.clone(u.DefaultOpts.filters)}return t.prototype.maxColorCount=function(t){return this.opts.colorCount=t,this},t.prototype.maxDimension=function(t){return this.opts.maxDimension=t,this},t.prototype.addFilter=function(t){return"function"==typeof t&&this.opts.filters.push(t),this},t.prototype.removeFilter=function(t){var r;return(r=this.opts.filters.indexOf(t))>0&&this.opts.filters.splice(r),this},t.prototype.clearFilters=function(){return this.opts.filters=[],this},t.prototype.quality=function(t){return this.opts.quality=t,this},t.prototype.useImage=function(t){return this.opts.Image=t,this},t.prototype.useGenerator=function(t){return this.opts.generator=t,this},t.prototype.useQuantizer=function(t){return this.opts.Quantizer=t,this},t.prototype.build=function(){return null==this.v&&(this.v=new u(this.src,this.opts)),this.v},t.prototype.getSwatches=function(t){return this.build().getPalette(t)},t.prototype.getPalette=function(t){return this.build().getPalette(t)},t.prototype.from=function(t){return new u(t,this.opts)},t}(),r.exports.Util=a,r.exports.Swatch=s,r.exports.Quantizer=t("./quantizer/"),r.exports.Generator=t("./generator/"),r.exports.Filter=t("./filter/")},{"./filter":5,"./filter/":5,"./generator":7,"./generator/":7,"./quantizer":16,"./quantizer/":16,"./swatch":19,"./util":20,quantize:1}],22:[function(t,n,o){if(!e)var e={map:function(t,r){var n={};return r?t.map(function(t,o){return n.index=o,r.call(n,t)}):t.slice()},naturalOrder:function(t,r){return t-r},sum:function(t,r){var n={};return t.reduce(r?function(t,o,e){return n.index=e,t+r.call(n,o)}:function(t,r){return t+r},0)},max:function(t,r){return Math.max.apply(null,r?e.map(t,r):t);

}};var i=function(){function t(t,r,n){return(t<<2*c)+(r<<c)+n}function n(t){function r(){n.sort(t),o=!0}var n=[],o=!1;return{push:function(t){n.push(t),o=!1},peek:function(t){return o||r(),void 0===t&&(t=n.length-1),n[t]},pop:function(){return o||r(),n.pop()},size:function(){return n.length},map:function(t){return n.map(t)},debug:function(){return o||r(),n}}}function o(t,r,n,o,e,i,s){var u=this;u.r1=t,u.r2=r,u.g1=n,u.g2=o,u.b1=e,u.b2=i,u.histo=s}function i(){this.vboxes=new n(function(t,r){return e.naturalOrder(t.vbox.count()*t.vbox.volume(),r.vbox.count()*r.vbox.volume())})}function s(n,e){var i,s,u,h,f=1<<3*c,l=new Uint32Array(f),v=1e6,m=0,y=1e6,d=0,w=1e6,x=0,S=n.length/4,_=0;if("function"==typeof e)for(;S>_;)offset=4*_,_++,r=n[offset+0],g=n[offset+1],b=n[offset+2],a=n[offset+3],e(r,g,b,a)||(s=r>>p,u=g>>p,h=b>>p,i=t(s,u,h),l[i]++,v>s?v=s:s>m&&(m=s),y>u?y=u:u>d&&(d=u),w>h?w=h:h>x&&(x=h));else for(;S>_;)offset=4*_,_++,r=n[offset+0],g=n[offset+1],b=n[offset+2],a=n[offset+3],s=r>>p,u=g>>p,h=b>>p,i=t(s,u,h),l[i]++,v>s?v=s:s>m&&(m=s),y>u?y=u:u>d&&(d=u),w>h?w=h:h>x&&(x=h);return{histo:l,vbox:new o(v,m,y,d,w,x,l)}}function u(r,n){function o(t){var r,o,e,i,s,u=t+"1",a=t+"2",p=0,f=y;for(e=n.copy(),i=n.copy(),r=f-n[u],o=n[a]-f,o>=r?(s=Math.min(n[a]-1,~~(f+o/2)),s=Math.max(0,s)):(s=Math.max(n[u],~~(f-1-r/2)),s=Math.min(n[a],s));!h[s];)s++;for(p=c[s];!p&&h[s-1];)p=c[--s];return e[a]=s,i[u]=e[a]+1,[e,i]}if(n.count()){var i=n.r2-n.r1+1,s=n.g2-n.g1+1,u=n.b2-n.b1+1,a=e.max([i,s,u]);if(1==n.count())return[n.copy()];var h,c,p,f,l,g,v,m=0,b="b";if(a==i)for(b="r",h=new Uint32Array(n.r2+1),p=n.r1;p<=n.r2;p++){for(g=0,f=n.g1;f<=n.g2;f++)for(l=n.b1;l<=n.b2;l++)v=t(p,f,l),g+=r[v];m+=g,h[p]=m}else if(a==s)for(b="g",h=new Uint32Array(n.g2+1),p=n.g1;p<=n.g2;p++){for(g=0,f=n.r1;f<=n.r2;f++)for(l=n.b1;l<=n.b2;l++)v=t(f,p,l),g+=r[v];m+=g,h[p]=m}else for(h=new Uint32Array(n.b2+1),p=n.b1;p<=n.b2;p++){for(g=0,f=n.r1;f<=n.r2;f++)for(l=n.g1;l<=n.g2;l++)v=t(f,l,p),g+=r[v];m+=g,h[p]=m}var y=-1;for(c=new Uint32Array(h.length),p=0;p<h.length;p++){var d=h[p];0>y&&d>m/2&&(y=p),c[p]=m-d}return o(b)}}function h(t,r){function o(t,n,o,e){for(var i=0;i<r.filters.length;i++){var s=r.filters[i];if(!s(t,n,o,e))return!0}return!1}function a(t,r){for(var n,o=1,e=0;f>e;)if(n=t.pop(),n.count()){var i=u(g,n),s=i[0],a=i[1];if(!s)return;if(t.push(s),a&&(t.push(a),o++),o>=r)return;if(e++>f)return}else e++}var h=r.colorCount;if(!t.length||2>h||h>256)return!1;var c=Array.isArray(r.filters)&&r.filters.length>0,p=s(t,c?houldIgnore:null),g=p.histo,v=(Object.keys(g).length,p.vbox),m=new n(function(t,r){return e.naturalOrder(t.count(),r.count())});m.push(v),a(m,l*h);for(var b=new n(function(t,r){return e.naturalOrder(t.count()*t.volume(),r.count()*r.volume())});m.size();)b.push(m.pop());a(b,h-b.size());for(var y=new i;b.size();){var d=b.pop(),w=v.avg();c&&o(w[0],w[1],w[2],255)||y.push(d)}return y}var c=5,p=8-c,f=1e3,l=.75;return o.prototype={volume:function(t){var r=this;return(!r._volume||t)&&(r._volume=(r.r2-r.r1+1)*(r.g2-r.g1+1)*(r.b2-r.b1+1)),r._volume},count:function(r){var n=this,o=n.histo;if(!n._count_set||r){var e,i,s,u=0;for(e=n.r1;e<=n.r2;e++)for(i=n.g1;i<=n.g2;i++)for(s=n.b1;s<=n.b2;s++)index=t(e,i,s),u+=o[index];n._count=u,n._count_set=!0}return n._count},copy:function(){var t=this;return new o(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(r){var n=this,o=n.histo;if(!n._avg||r){var e,i,s,u,a,h=0,p=1<<8-c,f=0,l=0,g=0;for(i=n.r1;i<=n.r2;i++)for(s=n.g1;s<=n.g2;s++)for(u=n.b1;u<=n.b2;u++)a=t(i,s,u),e=o[a],h+=e,f+=e*(i+.5)*p,l+=e*(s+.5)*p,g+=e*(u+.5)*p;n._avg=h?[~~(f/h),~~(l/h),~~(g/h)]:[~~(p*(n.r1+n.r2+1)/2),~~(p*(n.g1+n.g2+1)/2),~~(p*(n.b1+n.b2+1)/2)]}return n._avg},contains:function(t){var r=this,n=t[0]>>p;return gval=t[1]>>p,bval=t[2]>>p,n>=r.r1&&n<=r.r2&&gval>=r.g1&&gval<=r.g2&&bval>=r.b1&&bval<=r.b2}},i.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var r=this.vboxes,n=0;n<r.size();n++)if(r.peek(n).vbox.contains(t))return r.peek(n).color;return this.nearest(t)},nearest:function(t){for(var r,n,o,e=this.vboxes,i=0;i<e.size();i++)n=Math.sqrt(Math.pow(t[0]-e.peek(i).color[0],2)+Math.pow(t[1]-e.peek(i).color[1],2)+Math.pow(t[2]-e.peek(i).color[2],2)),(r>n||void 0===r)&&(r=n,o=e.peek(i).color);return o},forcebw:function(){var t=this.vboxes;t.sort(function(t,r){return e.naturalOrder(e.sum(t.color),e.sum(r.color))});var r=t[0].color;r[0]<5&&r[1]<5&&r[2]<5&&(t[0].color=[0,0,0]);var n=t.length-1,o=t[n].color;o[0]>251&&o[1]>251&&o[2]>251&&(t[n].color=[255,255,255])}},{quantize:h,getAll:s,medianCutApply:u}}();n.exports=i.quantize,n.exports.getAll=i.getAll,n.exports.splitBox=i.medianCutApply},{}]},{},[3]);